#! /usr/bin/env python

# Compute A_lam extinction in magnitudes using Cardelli, Clayton & Mathis (1989)
# with their R_V = 3.1

# ENTER MY CHOICE OF A_V HERE:
A_V = 1.0 

# Read the columns below for the output.  
# It reproduces CCM's Table 3 so that I can be sure I'm using their Eqs (1) - (3) 
# correctly.  Then the last column is A_lam for my choice of A_V above

import numpy as np 

R_V = 3.1   # the ratio worked out by Cardelli

print '\nR_V = 3.1 is fixed.'
print 'For your choice of A_V = ', A_V, ':\n'
print 'lam       x       a(x)            b(x)       A_lam/A_V   A_lam'
print '(um)    (1/um)                                           (mags)'
print '----    ------   ------          ------      ---------   ------'

################################################################################
# OPTICAL RANGE - Eqs (3a) and (3b)
x = np.arange( 1.1, 3.3 + 0.01, 0.01 )  # in 1 / microns
y = x - 1.82
lam = 1. / x                            # in microns
a = 1. + 0.17699*y - 0.50447*y**2 - 0.02427*y**3 + 0.72085*y**4 +\
         0.01979*y**5 - 0.77530*y**6 + 0.32999*y**7
b = 1.41338*y + 2.28305*y**2 + 1.07233*y**3 - 5.38434*y**4 -\
         0.62251*y**5 + 5.30260*y**6 - 2.09002*y**7

# compute ratio A_lam / A_V per Cardelli Eq. (1) (normalized by A_V)
normd_A_lam =  a + b / R_V 
A_lam = normd_A_lam * A_V

# pick out those wavelengths (in terms of x) displayed in Cardelli Table 3
# PLUS any wavelengths I want to add in between (within bounds of Eqs (3a),(3b)
table3_x = ( 2.78, 2.27, 1.82, 1.43, 1.11 )
for xt in table3_x:
    ind = np.abs( x - xt ).argmin()     # index of this x value to pick out
    print "%.2f \t %.2f \t %.4f \t %.4f \t %.3f \t %.3f" % \
            ( lam[ind], x[ind], a[ind], b[ind], normd_A_lam[ind], A_lam[ind] )




################################################################################
# INFRARED RANGE - Eqs (2a) and (2b)
x = np.arange( 0.29, 1.1 + 0.01, 0.01 )  # in 1 / microns
lam = 1. / x                            # in microns
a =  0.574 * x**1.61
b = -0.527 * x**1.61

# compute ratio A_lam / A_V per Cardelli Eq. (1) (normalized by A_V)
normd_A_lam =  a + b / R_V 
A_lam = normd_A_lam * A_V

# pick out those wavelengths (in terms of x) displayed in Cardelli Table 3
# PLUS any other ones I want included in the range
table3_x = ( 0.80, 0.63, 0.46, 0.29 )
for xt in table3_x:
    ind = np.abs( x - xt ).argmin()     # index of this x value to pick out
    print "%.2f \t %.2f \t %.4f \t %.4f \t %.3f \t %.3f" % \
            ( lam[ind], x[ind], a[ind], b[ind], normd_A_lam[ind], A_lam[ind] )

